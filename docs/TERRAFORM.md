<!-- BEGIN_TF_DOCS -->
## Requirements

| Name | Version |
|------|---------|
| terraform | >= 1.10 |
| google | >= 6.14, < 8 |

## Modules

| Name | Source | Version |
|------|--------|---------|
| cloud_armor_policy | GoogleCloudPlatform/cloud-armor/google | ~> 6.0 |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| project_id | Google Cloud project ID. | `string` | n/a | yes |
| adaptive_protection_auto_deploy_overwrites | Values to overwrite the default Adaptive Protection auto-deploy<br/>configuration provided by the baseline. The values here are used in the<br/>suggested rules created by Cloud Armor Adaptive Protection. Be aware that<br/>deviating from the baseline could reduce the effectiveness of the security<br/>policy and lead to security violation findings. The description of this<br/>object can be found in the upstream Cloud Armor [module documentation](https://registry.terraform.io/modules/GoogleCloudPlatform/cloud-armor/google/latest). | <pre>object({<br/>    enable      = optional(bool)<br/>    priority    = optional(number)<br/>    action      = optional(string)<br/>    preview     = optional(bool)<br/>    description = optional(string)<br/><br/>    load_threshold              = optional(number)<br/>    confidence_threshold        = optional(number)<br/>    impacted_baseline_threshold = optional(number)<br/>    expiration_sec              = optional(number)<br/><br/>    redirect_type   = optional(string)<br/>    redirect_target = optional(string)<br/><br/>    rate_limit_options = optional(object({<br/>      enforce_on_key      = optional(string)<br/>      enforce_on_key_name = optional(string)<br/><br/>      enforce_on_key_configs = optional(list(object({<br/>        enforce_on_key_name = optional(string)<br/>        enforce_on_key_type = optional(string)<br/>      })))<br/><br/>      exceed_action                        = optional(string)<br/>      rate_limit_http_request_count        = optional(number)<br/>      rate_limit_http_request_interval_sec = optional(number)<br/>      ban_duration_sec                     = optional(number)<br/>      ban_http_request_count               = optional(number)<br/>      ban_http_request_interval_sec        = optional(number)<br/>      exceed_redirect_options = optional(object({<br/>        type   = string<br/>        target = optional(string)<br/>      }))<br/>    }), {})<br/>  })</pre> | `{}` | no |
| automatic_service_enablement | Controls service enablement behaviour of the module. If set to false, the module will not enabled needed APIs. | `bool` | `true` | no |
| custom_rules | A map of rules which should be added on top of the rules provided by the<br/>baseline. The key of the map specifies the name of the rule. The<br/>description of this object can be found in the upstream Cloud Armor<br/>[module documentation](https://registry.terraform.io/modules/GoogleCloudPlatform/cloud-armor/google/latest). | <pre>map(object({<br/>    action                            = string<br/>    priority                          = number<br/>    description                       = optional(string)<br/>    preview                           = optional(bool, false)<br/>    expression                        = string<br/>    recaptcha_action_token_site_keys  = optional(list(string))<br/>    recaptcha_session_token_site_keys = optional(list(string))<br/>    redirect_type                     = optional(string, null)<br/>    redirect_target                   = optional(string, null)<br/>    rate_limit_options = optional(object({<br/>      enforce_on_key      = optional(string)<br/>      enforce_on_key_name = optional(string)<br/>      enforce_on_key_configs = optional(list(object({<br/>        enforce_on_key_name = optional(string)<br/>        enforce_on_key_type = optional(string)<br/>      })))<br/>      exceed_action                        = optional(string)<br/>      rate_limit_http_request_count        = optional(number)<br/>      rate_limit_http_request_interval_sec = optional(number)<br/>      ban_duration_sec                     = optional(number)<br/>      ban_http_request_count               = optional(number)<br/>      ban_http_request_interval_sec        = optional(number)<br/>      }),<br/>    {})<br/>    header_action = optional(list(object({<br/>      header_name  = optional(string)<br/>      header_value = optional(string)<br/>    })), [])<br/><br/>    preconfigured_waf_config_exclusions = optional(map(object({<br/>      target_rule_set = string<br/>      target_rule_ids = optional(list(string), [])<br/>      request_header = optional(list(object({<br/>        operator = string<br/>        value    = optional(string)<br/>      })))<br/>      request_cookie = optional(list(object({<br/>        operator = string<br/>        value    = optional(string)<br/>      })))<br/>      request_uri = optional(list(object({<br/>        operator = string<br/>        value    = optional(string)<br/>      })))<br/>      request_query_param = optional(list(object({<br/>        operator = string<br/>        value    = optional(string)<br/>      })))<br/>    })), null)<br/><br/>  }))</pre> | `{}` | no |
| description | Description of the Cloud Armor security policy. | `string` | `"METRO Baseline Security Policy"` | no |
| layer_7_ddos_defense_rule_visibility | Visibility level of the layer 7 DDOS rule. Can be set to `STANDARD` or<br/>`PREMIUM`. If set to `PREMIUM`, more detailed insights are provided for any<br/>generated DDoS protection rules. | `string` | `"PREMIUM"` | no |
| layer_7_ddos_defense_threshold_configs | Values to overwrite the default Adaptive Protection thresholds provided by<br/>the baseline. Be aware that deviating from the baseline could reduce the<br/>effectiveness of the security policy and lead to security violation<br/>findings. The description of this object can be found in the upstream Cloud<br/>Armor [module documentation](https://registry.terraform.io/modules/GoogleCloudPlatform/cloud-armor/google/latest). | <pre>list(object({<br/>    name                                    = optional(string)<br/>    auto_deploy_load_threshold              = optional(number)<br/>    auto_deploy_confidence_threshold        = optional(number)<br/>    auto_deploy_impacted_baseline_threshold = optional(number)<br/>    auto_deploy_expiration_sec              = optional(number)<br/>    detection_load_threshold                = optional(number)<br/>    detection_absolute_qps                  = optional(number)<br/>    detection_relative_to_baseline_qps      = optional(number)<br/>    traffic_granularity_configs = optional(list(object({<br/>      type                     = optional(string)<br/>      value                    = optional(string)<br/>      enable_each_unique_value = optional(bool)<br/>    })))<br/>  }))</pre> | `null` | no |
| log_level | Cloud Armor policy log level. Can be `NORMAL` or `VERBOSE`. | `string` | `"NORMAL"` | no |
| name | Name of the Cloud Armor security policy. | `string` | `"metro-baseline"` | no |
| pre_configured_rules_overwrites | Values to overwrite the default pre-configured rules provided by the<br/>baseline. Be aware that deviating from the baseline could reduce the<br/>effectiveness of the security policy and lead to security violation<br/>findings. The description of this object can be found in the upstream<br/>Cloud Armor [module documentation](https://registry.terraform.io/modules/GoogleCloudPlatform/cloud-armor/google/latest) | <pre>map(object({<br/>    enable                  = optional(bool)<br/>    action                  = optional(string)<br/>    priority                = optional(number)<br/>    description             = optional(string)<br/>    preview                 = optional(bool)<br/>    redirect_type           = optional(string)<br/>    redirect_target         = optional(string)<br/>    target_rule_set         = optional(string)<br/>    sensitivity_level       = optional(number)<br/>    include_target_rule_ids = optional(list(string), [])<br/>    exclude_target_rule_ids = optional(list(string), [])<br/>    rate_limit_options = optional(object({<br/>      enforce_on_key      = optional(string)<br/>      enforce_on_key_name = optional(string)<br/>      enforce_on_key_configs = optional(list(object({<br/>        enforce_on_key_name = optional(string)<br/>        enforce_on_key_type = optional(string)<br/>      })))<br/>      exceed_action                        = optional(string)<br/>      rate_limit_http_request_count        = optional(number)<br/>      rate_limit_http_request_interval_sec = optional(number)<br/>      ban_duration_sec                     = optional(number)<br/>      ban_http_request_count               = optional(number)<br/>      ban_http_request_interval_sec        = optional(number)<br/>    }), {})<br/><br/>    header_action = optional(list(object({<br/>      header_name  = optional(string)<br/>      header_value = optional(string)<br/>    })), [])<br/><br/>    preconfigured_waf_config_exclusions = optional(map(object({<br/>      target_rule_set = string<br/>      target_rule_ids = optional(list(string), [])<br/>      request_header = optional(list(object({<br/>        operator = string<br/>        value    = optional(string)<br/>      })))<br/>      request_cookie = optional(list(object({<br/>        operator = string<br/>        value    = optional(string)<br/>      })))<br/>      request_uri = optional(list(object({<br/>        operator = string<br/>        value    = optional(string)<br/>      })))<br/>      request_query_param = optional(list(object({<br/>        operator = string<br/>        value    = optional(string)<br/>      })))<br/>    })), null)<br/><br/>  }))</pre> | `{}` | no |
| security_rules | A map of security rules which should be added on top of the rules provided<br/>by the baseline. A security rule allows you to match traffic against IP<br/>CIDR ranges. The key of the map specifies the name of the rule. The<br/>description of this object can be found in the upstream Cloud Armor<br/>[module documentation](https://registry.terraform.io/modules/GoogleCloudPlatform/cloud-armor/google/latest). | <pre>map(object({<br/>    action          = string<br/>    priority        = number<br/>    description     = optional(string)<br/>    preview         = optional(bool, false)<br/>    redirect_type   = optional(string, null)<br/>    redirect_target = optional(string, null)<br/>    src_ip_ranges   = list(string)<br/>    rate_limit_options = optional(object({<br/>      enforce_on_key      = optional(string)<br/>      enforce_on_key_name = optional(string)<br/>      enforce_on_key_configs = optional(list(object({<br/>        enforce_on_key_name = optional(string)<br/>        enforce_on_key_type = optional(string)<br/>      })))<br/>      exceed_action                        = optional(string)<br/>      rate_limit_http_request_count        = optional(number)<br/>      rate_limit_http_request_interval_sec = optional(number)<br/>      ban_duration_sec                     = optional(number)<br/>      ban_http_request_count               = optional(number)<br/>      ban_http_request_interval_sec        = optional(number)<br/>    }), {})<br/>    header_action = optional(list(object({<br/>      header_name  = optional(string)<br/>      header_value = optional(string)<br/>    })), [])<br/>  }))</pre> | `{}` | no |
| threat_intelligence_rules_overwrites | Values to overwrite the default threat intelligence rules provided by the<br/>baseline. Be aware that deviating from the baseline could reduce the<br/>effectiveness of the security policy and lead to security violation<br/>findings. The description of this object can be found in the upstream<br/>Cloud Armor [module documentation](https://registry.terraform.io/modules/GoogleCloudPlatform/cloud-armor/google/latest) | <pre>map(object({<br/>    enable      = optional(bool)<br/>    action      = optional(string)<br/>    priority    = optional(number)<br/>    description = optional(string)<br/>    preview     = optional(bool)<br/>    feed        = optional(string)<br/>    exclude_ip  = optional(string)<br/>    rate_limit_options = optional(object({<br/>      enforce_on_key      = optional(string)<br/>      enforce_on_key_name = optional(string)<br/>      enforce_on_key_configs = optional(list(object({<br/>        enforce_on_key_name = optional(string)<br/>        enforce_on_key_type = optional(string)<br/>      })))<br/>      exceed_action                        = optional(string)<br/>      rate_limit_http_request_count        = optional(number)<br/>      rate_limit_http_request_interval_sec = optional(number)<br/>      ban_duration_sec                     = optional(number)<br/>      ban_http_request_count               = optional(number)<br/>      ban_http_request_interval_sec        = optional(number)<br/>    }), {})<br/>    header_action = optional(list(object({<br/>      header_name  = optional(string)<br/>      header_value = optional(string)<br/>    })), [])<br/>  }))</pre> | `{}` | no |

## Outputs

| Name | Description |
|------|-------------|
| policy | Security policy created |
<!-- END_TF_DOCS -->

[FAQ]: FAQ.md
